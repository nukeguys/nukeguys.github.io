{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/dev/easy-git/","result":{"data":{"site":{"siteMetadata":{"title":"nukeguys blog","author":"nukeguys","google_ad_client":"ca-pub-3962171616803555"}},"markdownRemark":{"id":"0a59d145-daa3-55ff-8205-2042d1f8c864","excerpt":"개발을 하다보니 너무나 당연하게도 git을 사용한다. 처음부터 git을 cli로만 사용하다보니 Sourcetree나 Tower 같은 GUI client를 사용하는 것보다 직접 타이핑 하는게 오히려 더 편하게 느껴진다. 하지만 cli…","html":"<p>개발을 하다보니 너무나 당연하게도 git을 사용한다. 처음부터 git을 cli로만 사용하다보니 <a href=\"https://www.sourcetreeapp.com/\">Sourcetree</a>나 <a href=\"https://www.git-tower.com\">Tower</a> 같은 GUI client를 사용하는 것보다 직접 타이핑 하는게 오히려 더 편하게 느껴진다. 하지만 cli 특성상 타이핑이 많거나 반복되는 경우가 생긴다. 게으름이 기술의 발전을 이끈다고 하던가… 귀차니즘이 너무 심해질 때 마다 하나씩 해결했던 방법들을 몇가지 정리해 본다.</p>\n<h2>1. checkout의 귀차니즘</h2>\n<p>작업을 하다보면 새로 만들거나 혹은 리뷰를 위해 다른 브랜치를 pull 하거나 등등으로 여러 브랜치 사이를 이동하는 경우는 흔한 일이다. 그러나 브랜치명이 길다면 매번 입력하는건 여간 귀찮은 일이 아니다. 사실 <a href=\"https://ohmyz.sh/\">Zsh</a>을 사용하고 있어 탭과 방향키 만으로 브랜치를 선택할 수는 있지만 순간 손을 이동해야 한다. 타이핑을 하다가 방향키로 손을 움직이는 것도 번거로워 진 시점에 현재 로컬의 브랜치들의 리스트를 보여주고 번호 입력으로 checkout을 하는 python script(<a href=\"https://github.com/nukeguys/utils\">github</a>)를 작성했었다.\n이외에도 python으로 일에 필요한 것들을 작성했었는데 지금은 사용하지 않고 있다. 동작은 아래에서 확인 할 수 있다.</p>\n<p><a href=\"https://asciinema.org/a/270031\"><img src=\"https://asciinema.org/a/270031.svg\" alt=\"asciicast\"></a></p>\n<h2>2. alias 설정하기</h2>\n<p>option으로 command 자체가 길어지거나, 빈번하게 command를 연속해서 입력해야 하는 경우에는 축약하거나 한 번에 처리하고 싶어진다. 이런 경우에는 <a href=\"https://git-scm.com/book/ko/v2/Git%EC%9D%98-%EA%B8%B0%EC%B4%88-Git-Alias\">alias</a>를 설정할 수 있다. 간단한 git command 부터 bash 함수까지 실행이 가능하기 때문에 생각보다 많은 것들이 가능해진다.</p>\n<p>내가 처음 사용했던건 log를 좀 더 이쁘게 보기 위한 alias 였다. 이후에 사용하면서 필요하다 싶은 것들을 하나씩 추가했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span>alias<span class=\"token punctuation\">]</span>\n\ts <span class=\"token operator\">=</span> status\n\ta <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>git <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> status\n\tau <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>git <span class=\"token function\">add</span> -u <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> status\n\taa <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>git <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> <span class=\"token function\">add</span> -u <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> status\n\tc <span class=\"token operator\">=</span> commit\n\tcm <span class=\"token operator\">=</span> commit -m\n\tca <span class=\"token operator\">=</span> commit --amend <span class=\"token comment\"># careful</span>\n\tac <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>git <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> commit\n\tacm <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>git <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> commit -m\n\tl <span class=\"token operator\">=</span> log --graph --all --pretty<span class=\"token operator\">=</span>format:<span class=\"token string\">'%C(yellow)%h%C(cyan)%d%Creset %s %C(white)- %an, %ar%Creset'</span>\n\tll <span class=\"token operator\">=</span> log --stat --abbrev-commit\n\tlg <span class=\"token operator\">=</span> log --pretty<span class=\"token operator\">=</span>format:<span class=\"token string\">'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an>%Creset'</span> --abbrev-commit\n\tllg <span class=\"token operator\">=</span> log --color --graph --pretty<span class=\"token operator\">=</span>format:<span class=\"token string\">'%C(bold white)%H %d%Creset%n%s%n%+b%C(bold blue)%an &lt;%ae>%Creset %C(bold green)%cr (%ci)'</span> --abbrev-commit\n\td <span class=\"token operator\">=</span> <span class=\"token function\">diff</span>\n\tlgdiff <span class=\"token operator\">=</span> <span class=\"token string\">\"!f() { git log --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an>%Creset' --abbrev-commit <span class=\"token variable\">$1</span>..<span class=\"token variable\">$2</span>;}; f\"</span>\n\tlgraph <span class=\"token operator\">=</span> log --graph --pretty<span class=\"token operator\">=</span>format:<span class=\"token string\">'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an>%Creset'</span> --abbrev-commit\n\tbranch-name <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>git rev-parse --abbrev-ref HEAD\n\tpublish <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>git push -u origin <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">git</span> branch-name<span class=\"token variable\">)</span></span>\n\trm-remote <span class=\"token operator\">=</span> <span class=\"token string\">\"!f() { git push origin --no-verify :<span class=\"token variable\">$1</span>; }; f\"</span>\n\trb <span class=\"token operator\">=</span> <span class=\"token string\">\"!f() { git branch -D <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">git</span> branch <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -E $1<span class=\"token variable\">)</span></span>; }; f\"</span>\n\trt <span class=\"token operator\">=</span> <span class=\"token string\">\"!f() { git tag -d <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">git</span> tag -l $1<span class=\"token variable\">)</span></span>; }; f\"</span>\n\trrt <span class=\"token operator\">=</span> <span class=\"token string\">\"!f() { git push origin --no-verify -d <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">git</span> tag -l $1<span class=\"token variable\">)</span></span>; }; f\"</span>\n\taliases <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>git config --list <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">'alias<span class=\"token entity\" title=\"\\\\\">\\\\</span>.'</span> <span class=\"token operator\">|</span> <span class=\"token function\">sed</span> <span class=\"token string\">'s/alias<span class=\"token entity\" title=\"\\\\\">\\\\</span>.<span class=\"token entity\" title=\"\\\\\">\\\\</span>([^=]*<span class=\"token entity\" title=\"\\\\\">\\\\</span>)=<span class=\"token entity\" title=\"\\\\\">\\\\</span>(.*<span class=\"token entity\" title=\"\\\\\">\\\\</span>)/<span class=\"token entity\" title=\"\\\\\">\\\\</span>1<span class=\"token entity\" title=\"\\\\\">\\\\</span><span class=\"token entity\" title=\"\\t\">\\t</span> => <span class=\"token entity\" title=\"\\\\\">\\\\</span>2/'</span> <span class=\"token operator\">|</span> <span class=\"token function\">sort</span>\n\tcb <span class=\"token operator\">=</span> <span class=\"token string\">\"!f() { git checkout -b feature/KG-<span class=\"token variable\">$1</span>-<span class=\"token variable\">$2</span>; }; f\"</span></code></pre></div>\n<p>아래는 내가 가장 빈번하게 사용하는 alias들이다.<br>\n<code>publish</code> - remote에 현재 브랜치 push<br>\n<code>rb</code> - 정규식에 매핑되는 로컬 브랜치 삭제 / <code>rm-remote</code> - remote 브랜치 삭제<br>\n<code>cb</code> - 특정 포맷에 맞게 브랜치 생성 / <code>ca</code> - commit —amend 줄여쓰기<br>\n<code>ac</code> - add, commit 한 번에 하기 / <code>lg</code> - log 이쁘게 보기</p>\n<p>등록된 alias들이 기억나지 않을 땐 <code>git aliases</code>를 통해 list 확인이 가능하다. 구글링하면 유용한 alias들이 많으니 자신이 자주 사용하는 것들을 등록하고 사용하면 생각보다 많이 편리하다.</p>\n<h2>3. commit message에 이슈 번호 자동 입력하기</h2>\n<p>commit message는 어느정도 가이드라인을 지켜주는게 이력들을 볼 때 편하다. 하지만 매번 기억하기는 어렵기 때문에 commit시 템플릿을 사용하도록 설정해 놓으면 잊지 않고 지킬 수 있다. template 설정도 alias처럼 config 파일에 직접 추가하거나 <code>git config --global commit.template ~/.gitmessage.txt</code> command를 사용할 수 있다.(global 옵션을 사용하지 않으면 repository별로 설정도 가능하다.) 난 개인적으로 <a href=\"https://chris.beams.io/posts/git-commit/\">How to Write a Git Commit Message</a>를 참고해서 아래와 같은 template을 사용하고 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># &lt;type>: (If applied, this commit will...) &lt;subject> (Max 50 char)</span>\n<span class=\"token comment\"># |&lt;----  Using a Maximum Of 50 Characters  ---->|</span>\n<span class=\"token punctuation\">[</span>ISSUE-NUMBER<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># Explain why this change is being made</span>\n<span class=\"token comment\"># |&lt;----   Try To Limit Each Line to a Maximum Of 72 Characters   ---->|</span>\n\n\n<span class=\"token comment\"># Provide links or keys to any relevant tickets, articles or other resources</span>\nResolves: ISSUE-NUMBER\n\n<span class=\"token comment\"># --- COMMIT END ---</span>\n<span class=\"token comment\"># Type can be</span>\n<span class=\"token comment\">#    feat     (new feature)</span>\n<span class=\"token comment\">#    fix      (bug fix)</span>\n<span class=\"token comment\">#    refactor (refactoring production code)</span>\n<span class=\"token comment\">#    style    (formatting, missing semi colons, etc; no code change)</span>\n<span class=\"token comment\">#    docs     (changes to documentation)</span>\n<span class=\"token comment\">#    test     (adding or refactoring tests; no production code change)</span>\n<span class=\"token comment\">#    chore    (updating grunt tasks etc; no production code change)</span>\n<span class=\"token comment\"># --------------------</span>\n<span class=\"token comment\"># Remember to</span>\n<span class=\"token comment\">#    Capitalize the subject line</span>\n<span class=\"token comment\">#    Use the imperative mood in the subject line</span>\n<span class=\"token comment\">#    Do not end the subject line with a period</span>\n<span class=\"token comment\">#    Separate subject from body with a blank line</span>\n<span class=\"token comment\">#    Use the body to explain what and why vs. how</span>\n<span class=\"token comment\">#    Can use multiple lines with \"-\" for bullet points in body</span>\n<span class=\"token comment\"># --------------------</span></code></pre></div>\n<p>그런데 최근에 계속 작성을 하면서 issue 번호를 입력하는 부분이 너무 번거로웠다. 왜냐하면 기본적으로 branch 명에 이슈 번호를 포함해서 정해진 포맷으로 사용하고 있고(이것도 귀찮아서 만든게 <code>cb</code> alias다.) commit시 현재 브랜치명에서 issue 번호를 가져다 template을 자동으로 채워주면 좋겠다는 생각이 들었다.\n그래서 <code>prepare-commit-msg</code> hook을 작성했다. hook은 git workflow의 전후로 script를 실행할 수 있게 해준다. (설정 방법과 자세한 설명은 <a href=\"https://git-scm.com/book/ko/v2/Git%EB%A7%9E%EC%B6%A4-Git-Hooks\">Git - Git 훅</a>을 참고)\n직접 hook directory에 파일을 작성할 수도 있지만 <a href=\"https://github.com/typicode/husky\">husky</a>를 사용하면 hook을 좀 더 쉽게 관리할 수도 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token assign-left variable\">COMMIT_MSG_FILE</span><span class=\"token operator\">=</span><span class=\"token variable\">$1</span>\n<span class=\"token assign-left variable\">ISSUE_NUMBER_TAG</span><span class=\"token operator\">=</span><span class=\"token string\">'ISSUE-NUMBER'</span>\n\n<span class=\"token assign-left variable\">branch_name</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">git</span> rev-parse --abbrev-ref HEAD<span class=\"token variable\">`</span></span>\n<span class=\"token assign-left variable\">issue_number</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token builtin class-name\">echo</span> $<span class=\"token punctuation\">{</span>branch_name<span class=\"token punctuation\">}</span> <span class=\"token operator\">|</span> <span class=\"token function\">sed</span> -n <span class=\"token string\">'s/^feature\\/\\(.*-[0-9]*\\)-.*/<span class=\"token entity\" title=\"\\1\">\\1</span>/p'</span><span class=\"token variable\">`</span></span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> -n <span class=\"token string\">\"<span class=\"token variable\">$issue_number</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n  <span class=\"token function\">sed</span> -i <span class=\"token string\">\".bak\"</span> <span class=\"token string\">\"s/<span class=\"token variable\">${ISSUE_NUMBER_TAG}</span>/<span class=\"token variable\">${issue_number}</span>/g\"</span> <span class=\"token variable\">${COMMIT_MSG_FILE}</span>\n<span class=\"token keyword\">fi</span></code></pre></div>\n<h2>4. tig (text-mode interface for Git) 사용</h2>\n<p><a href=\"https://github.com/jonas/tig\">tig</a>는 텍스트 기반의 git client다. 따라서 terminal 벗어나지 않아도 되고 커스터마이징이 가능하기 때문에 잘만 사용하면 상당히 유용하다. (나도 간단하게만 사용하고 있는데 좀 더 활용을 해보고 나중에 다시 정리해봐야겠다.)\ntig 메뉴얼은 친절하게 한국어로 번역(<a href=\"https://ujuc.github.io/2016/02/10/tig-manual/\">[번역] Tig Manual</a>)된 것이 있으니 한 번 읽어보면 좋을 듯하다.</p>\n<p>이외에도 github 사용을 편하게 만들어주는 <a href=\"https://hub.github.com/\">hub</a>도 있고, 간단한 설정이나 script를 작성하면 cli를 사용하는 불편함들을 많이 제거할 수 있다.</p>","frontmatter":{"title":"Git 사용 팁 정리","date":"2019/09/21 10:55","tags":["git","cli","git-hook","alias"],"description":"git cli를 사용하다 생긴 귀차니즘 없애기"}}},"pageContext":{"slug":"/dev/easy-git/","previous":{"fields":{"slug":"/life/i-wish/"},"frontmatter":{"title":"보름달에 소원 빌기"}},"next":{"fields":{"slug":"/book/dept-and-rich-9788950967789/"},"frontmatter":{"title":"빚 권하는 사회에서 부자되는 법"}}}}}